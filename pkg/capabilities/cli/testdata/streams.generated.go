// Code generated by pkg/capabilities/cli, DO NOT EDIT.

package streams

import "encoding/json"
import "fmt"

// Streams Trigger
type StreamsCapability struct {
	// Config corresponds to the JSON schema field "config".
	Config StreamsCapabilityConfig

	// Outputs corresponds to the JSON schema field "outputs".
	Outputs []StreamsCapabilityOutputsElem
}

type StreamsCapabilityConfig struct {
	// FeedIds corresponds to the JSON schema field "feedIds".
	FeedIds []string

	// MaxFrequencyMs corresponds to the JSON schema field "maxFrequencyMs".
	MaxFrequencyMs int
}

// UnmarshalJSON implements json.Unmarshaler.
func (j *StreamsCapabilityConfig) UnmarshalJSON(b []byte) error {
	var raw map[string]interface{}
	if err := json.Unmarshal(b, &raw); err != nil {
		return err
	}
	if _, ok := raw["feedIds"]; raw != nil && !ok {
		return fmt.Errorf("field feedIds in StreamsCapabilityConfig: required")
	}
	if _, ok := raw["maxFrequencyMs"]; raw != nil && !ok {
		return fmt.Errorf("field maxFrequencyMs in StreamsCapabilityConfig: required")
	}
	type Plain StreamsCapabilityConfig
	var plain Plain
	if err := json.Unmarshal(b, &plain); err != nil {
		return err
	}
	if plain.FeedIds != nil && len(plain.FeedIds) < 1 {
		return fmt.Errorf("field %s length: must be >= %d", "feedIds", 1)
	}
	*j = StreamsCapabilityConfig(plain)
	return nil
}

type StreamsCapabilityOutputsElem struct {
	// This value is extracted from the fullReport. Benchmark price represented as
	// bytes encoded as base64 string.
	BenchmarkPrice string

	// FeedId corresponds to the JSON schema field "feedId".
	FeedId string

	// Full report represented as bytes encoded as base64 string.
	FullReport string

	// This value is extracted from the fullReport. A unix timestamp represented as an
	// int64 value. Timestamp is captured at the time of report creation.
	ObservationTimestamp int

	// Report context represented as bytes encoded as base64 string. This is required
	// to validate the signatures.
	ReportContext string

	// Signature over full report and report context represented as bytes encoded as
	// base64 string.
	Signatures []string
}

// UnmarshalJSON implements json.Unmarshaler.
func (j *StreamsCapabilityOutputsElem) UnmarshalJSON(b []byte) error {
	var raw map[string]interface{}
	if err := json.Unmarshal(b, &raw); err != nil {
		return err
	}
	if _, ok := raw["benchmarkPrice"]; raw != nil && !ok {
		return fmt.Errorf("field benchmarkPrice in StreamsCapabilityOutputsElem: required")
	}
	if _, ok := raw["feedId"]; raw != nil && !ok {
		return fmt.Errorf("field feedId in StreamsCapabilityOutputsElem: required")
	}
	if _, ok := raw["fullReport"]; raw != nil && !ok {
		return fmt.Errorf("field fullReport in StreamsCapabilityOutputsElem: required")
	}
	if _, ok := raw["observationTimestamp"]; raw != nil && !ok {
		return fmt.Errorf("field observationTimestamp in StreamsCapabilityOutputsElem: required")
	}
	if _, ok := raw["reportContext"]; raw != nil && !ok {
		return fmt.Errorf("field reportContext in StreamsCapabilityOutputsElem: required")
	}
	if _, ok := raw["signatures"]; raw != nil && !ok {
		return fmt.Errorf("field signatures in StreamsCapabilityOutputsElem: required")
	}
	type Plain StreamsCapabilityOutputsElem
	var plain Plain
	if err := json.Unmarshal(b, &plain); err != nil {
		return err
	}
	if plain.Signatures != nil && len(plain.Signatures) < 1 {
		return fmt.Errorf("field %s length: must be >= %d", "signatures", 1)
	}
	*j = StreamsCapabilityOutputsElem(plain)
	return nil
}

// UnmarshalJSON implements json.Unmarshaler.
func (j *StreamsCapability) UnmarshalJSON(b []byte) error {
	var raw map[string]interface{}
	if err := json.Unmarshal(b, &raw); err != nil {
		return err
	}
	if _, ok := raw["config"]; raw != nil && !ok {
		return fmt.Errorf("field config in StreamsCapability: required")
	}
	if _, ok := raw["outputs"]; raw != nil && !ok {
		return fmt.Errorf("field outputs in StreamsCapability: required")
	}
	type Plain StreamsCapability
	var plain Plain
	if err := json.Unmarshal(b, &plain); err != nil {
		return err
	}
	*j = StreamsCapability(plain)
	return nil
}
